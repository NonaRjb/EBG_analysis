wandb: Appending key for api.wandb.ai to your netrc file: /Midgard/home/nonar/.netrc
wandb: Starting wandb agent üïµÔ∏è
2024-02-08 09:29:01,226 - wandb.wandb_agent - INFO - Running runs: []
2024-02-08 09:29:05,637 - wandb.wandb_agent - INFO - Agent received command: run
2024-02-08 09:29:05,638 - wandb.wandb_agent - INFO - Agent starting run with config:
	batch_size: 32
	data: dataset1
	dropout: 0.25
	ebg_transform: tfr_morlet
	eeg: lstm
	epoch: 300
	hidden_size: 64
	lr: 0.0001
	num_layers: 1
	optim_name: adamw
	seed: 42
	subject_id: 0
	tmax: 0.3
	tmin: -0.1
2024-02-08 09:29:05,650 - wandb.wandb_agent - INFO - About to run command: /usr/bin/env python /Midgard/home/nonar/EBG_analysis/train.py --batch_size=32 --data=dataset1 --dropout=0.25 --ebg_transform=tfr_morlet --eeg=lstm --epoch=300 --hidden_size=64 --lr=0.0001 --num_layers=1 --optim_name=adamw --seed=42 --subject_id=0 --tmax=0.3 --tmin=-0.1
2024-02-08 09:29:10,664 - wandb.wandb_agent - INFO - Running runs: ['1i2wq9o2']
wandb: Currently logged in as: nonar (nona-phd). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.3 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in /Midgard/home/nonar/EBG_analysis/wandb/run-20240208_092912-1i2wq9o2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fallen-sweep-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/nona-phd/EBG_Olfaction
wandb: üßπ View sweep at https://wandb.ai/nona-phd/EBG_Olfaction/sweeps/b53264rn
wandb: üöÄ View run at https://wandb.ai/nona-phd/EBG_Olfaction/runs/1i2wq9o2
/Midgard/home/nonar/miniconda3/envs/eegnet_pytorch/lib/python3.9/site-packages/torch/nn/modules/rnn.py:62: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.25 and num_layers=1
  warnings.warn("dropout option adds dropout after all but last "
  0%|          | 0/53 [00:00<?, ?it/s]  0%|          | 0/53 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/Midgard/home/nonar/EBG_analysis/train.py", line 135, in <module>
    best_model = trainer.train(train_loader, val_loader)
  File "/Midgard/home/nonar/EBG_analysis/models/trainer.py", line 59, in train
    preds = self.model(x)
  File "/Midgard/home/nonar/miniconda3/envs/eegnet_pytorch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/Midgard/home/nonar/EBG_analysis/models/lstm.py", line 36, in forward
    output, (hn, cn) = self.lstm(x, (h_0, c_0))
  File "/Midgard/home/nonar/miniconda3/envs/eegnet_pytorch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/Midgard/home/nonar/miniconda3/envs/eegnet_pytorch/lib/python3.9/site-packages/torch/nn/modules/rnn.py", line 767, in forward
    self.check_forward_args(input, hx, batch_sizes)
  File "/Midgard/home/nonar/miniconda3/envs/eegnet_pytorch/lib/python3.9/site-packages/torch/nn/modules/rnn.py", line 692, in check_forward_args
    self.check_input(input, batch_sizes)
  File "/Midgard/home/nonar/miniconda3/envs/eegnet_pytorch/lib/python3.9/site-packages/torch/nn/modules/rnn.py", line 205, in check_input
    raise RuntimeError(
RuntimeError: input.size(-1) must be equal to input_size. Expected 160, got 4
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.021 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.021 MB uploaded (0.000 MB deduped)wandb: üöÄ View run fallen-sweep-1 at: https://wandb.ai/nona-phd/EBG_Olfaction/runs/1i2wq9o2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240208_092912-1i2wq9o2/logs
Traceback (most recent call last):
  File "/Midgard/home/nonar/EBG_analysis/train.py", line 135, in <module>
    best_model = trainer.train(train_loader, val_loader)
  File "/Midgard/home/nonar/EBG_analysis/models/trainer.py", line 59, in train
    preds = self.model(x)
  File "/Midgard/home/nonar/miniconda3/envs/eegnet_pytorch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/Midgard/home/nonar/EBG_analysis/models/lstm.py", line 36, in forward
    output, (hn, cn) = self.lstm(x, (h_0, c_0))
  File "/Midgard/home/nonar/miniconda3/envs/eegnet_pytorch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/Midgard/home/nonar/miniconda3/envs/eegnet_pytorch/lib/python3.9/site-packages/torch/nn/modules/rnn.py", line 767, in forward
    self.check_forward_args(input, hx, batch_sizes)
  File "/Midgard/home/nonar/miniconda3/envs/eegnet_pytorch/lib/python3.9/site-packages/torch/nn/modules/rnn.py", line 692, in check_forward_args
    self.check_input(input, batch_sizes)
  File "/Midgard/home/nonar/miniconda3/envs/eegnet_pytorch/lib/python3.9/site-packages/torch/nn/modules/rnn.py", line 205, in check_input
    raise RuntimeError(
RuntimeError: input.size(-1) must be equal to input_size. Expected 160, got 4
2024-02-08 09:30:00,453 - wandb.wandb_agent - INFO - Cleaning up finished run: 1i2wq9o2
2024-02-08 09:30:01,991 - wandb.wandb_agent - INFO - Agent received command: exit
2024-02-08 09:30:01,991 - wandb.wandb_agent - INFO - Received exit command. Killing runs and quitting.
wandb: Terminating and syncing runs. Press ctrl-c to kill.
